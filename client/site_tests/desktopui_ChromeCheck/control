# Copyright 2017 The ChromiumOS Authors
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# TEST SOON TO BE DISABLED UNTIL MIGRATED TO PYTHON 3.
# For instructions on how to: go/tauto-py3-migration
# To re-enable migrate to Python 3.
# If the test is not migrated by 1/14/22 it will be deleted.

AUTHOR = "derat, chromeos-ui"
NAME = "desktopui_ChromeCheck"
ATTRIBUTES = "suite:bvt-perbuild, suite:distributed_lab_qual_bvt_shard1"
TIME = "SHORT"
TEST_CATEGORY = "General"
TEST_CLASS = "desktopui"
TEST_TYPE = "client"
JOB_RETRIES = 0

DOC = """
Test that Chrome is at least marginally usable.

Uses Telemetry to log in, load a simple HTML page, and log out. Along the way,
tests that session_manager emits the expected SessionStateChanged D-Bus signal
about the session starting and that the user's encrypted home directory is
mounted.

A failure can indicate several things:

- Telemetry-to-Chrome communication isn't working (is Chrome crashing?).
- Chrome and session_manager aren't coordinating login properly.
- Chrome is internally broken and can't load web pages.
- Chrome and cryptohome aren't coordinating user home dir mounting properly.

That's a fairly broad range of causes. They're all covered here with the intent
of providing a single fast-running, minimally-flaky test that can be used to
validate new versions of Chrome before integrating them into ChromeOS.

The info log provides high-level information about what the test is doing and
can hopefully be used to narrow down the location of failure.
"""

job.run_test('desktopui_ChromeCheck')
