# Copyright 2023 The ChromiumOS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

NAME = 'network_WiFi_ChaosConnectDisconnect.static_2Ghz'
METADATA = {
    'contacts': ['chromeos-connectivity-engprod@google.com'],
    'requirements': ['wifi-gen-0002-v01', 'wifi-proc-0009-v01', 'wifi-proc-0012-v01', 'wifi-proc-0013-v01', 'wifi-proc-0016-v01', 'wifi-proc-0020-v01'],
    'bug_component': 'b:978946',
    'criteria': 'This test iterates through all 2Ghz APs in Chaos chamber '
                'and connects/disconnects with DUT.',
    'hw_agnostic': False
}
TEST_TYPE = 'server'
ATTRIBUTES = 'suite:wifi_interop'
DEPENDENCIES = 'chaos_dut'
MAX_RESULT_SIZE_KB = 512000

from autotest_lib.server.cros.ap_configurators import ap_spec
from autotest_lib.server.cros.chaos_lib import static_runner

def run_chaos_static(machine):
    host = hosts.create_host(machine)
    # Test all 2Ghz static APs on channel 1, 6 and 11
    ap_specs = [ap_spec.APSpec(band=ap_spec.BAND_2GHZ,
                               channel = 1,
                               configurator_type=ap_spec.CONFIGURATOR_STATIC),
                ap_spec.APSpec(band=ap_spec.BAND_2GHZ,
                               channel = 6,
                               configurator_type=ap_spec.CONFIGURATOR_STATIC),
                ap_spec.APSpec(band=ap_spec.BAND_2GHZ,
                               channel = 11,
                               configurator_type=ap_spec.CONFIGURATOR_STATIC)]

    for spec in ap_specs:
        runner = static_runner.StaticRunner(
                'network_WiFi_ChaosConnectDisconnect', host, spec)
        runner.run(job)

parallel_simple(run_chaos_static, machines)
